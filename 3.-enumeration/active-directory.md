# Active Directory

### Enumeration

#### PowerView

First, modify the powershell execution policy to enable script execution.

```
Set-ExecutionPolicy -ExecutionPolicy (RemoteSigned) or (Bypass)
```

Next, upload powerview.ps1 (using method of choice) and dot source&#x20;

```
. .\script.ps1 (be sure to include the space between ellipses)
```

#### Basic enumeration

```
Get-Domain
Get-DomainPolicy
(Get-DomainPolicy).KerberosPolicy
Get-DomainController
Get-DomainUser -Identity student1
Get-DomainGroup
Get-DomainGroupMember -Identity "Domain Admins" -Recurse
Get-DomainComputer
Get-DomainComputer | select Name
Get-DomainUser
Get-DomainUser | select samaccountname
Get-DomainUser -SPN | select serviceprincipalname
Get-NetLoggedon -ComputerName (requires local admin rights)
```

#### Domain enumeration

```
Get-DomainGPO
Get-DomainOU | select name
```

#### User hunting

```
Find-LocalAdminAccess -Verbose : Finds all machines on the domain where the current user has local admin access
Find-DomainUserLocation -Verbose
Find-DomainUserLocation -UserGroupIdentity : Find computers where a domain admin (or specified user/group) has sessions
```

