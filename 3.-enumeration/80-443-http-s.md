# 80/443 - HTTP(s)

HTTP is typically one of the most rewarding exploitation vectors.  Because of the wide range of technologies and implementations, HTTP servers are challenging to secure--which is a great opportunity for pentesters.  When reviewing web servers/applications, here are some areas to focus on.

## Enumeration process

### 1. Review the web page in a browser

* Identify links, input fields, login pages, etc.
* Note version or software information--many CMS have known exploits
* Review the page source, look for version info, comments, etc.
* Look at URLs , look for possible LFI/RFI
* Check for sitemaps/robots.txt

### 2. Review interesting items in a proxy interceptor

* Input fields
* Login forms
* Check headers, observe how the web page and server exchange information&#x20;

### 3. Scan for vulnerabilities

```
nikto -host 10.11.1.5
```

### 4. Identify underlying server technologies

* [WhatWeb](https://github.com/urbanadventurer/WhatWeb) - Tool with over 1,800 plugins designed to help identify website technologies.&#x20;
* [Wappalyzer](https://www.wappalyzer.com/) - Webiste and plugin for recognizing website technologies.

### 5. Scan for open directories

Look for filetypes based on what you know about the web server. Also use forced browsing to locate existing directories.

```
Microsoft IIS - .asp or .aspx (+ html)
Apache - .php (+ html)
Tomcat - .war (+ html)
other - .pdf, .doc, .xls, .xlsx, .ppt, .pptx
```

#### Directory busting methodology (order of precedence)

```
.php OR .asp, .aspx AND .html AND .txt
.doc, .docx, .xls, .pdf
.webconfig, .config, .json, .yml, .env
.bk, .bak, .swp
.zip, .log
```

#### Dirsearch

```
python3 dirsearch.py -u http://10.10.87.202:3333/ -e html -x 401,402,403

-e: extensions to include
-x: status codes to exclude
-f: forces the addition of extensions on every wordlist entry
-w: woD
```

#### Dirb

```
dirb $ipaddress
-X filetype : searches for specific files
```

#### ffuf

```
ffuf -w wordlist.txt -u http://somesite.com/FUZZ
ffuf -w wordlist.txt -u http://somesite.com/FUZZ -e .aspx,.html,.php,.txt
ffuf -w wordlist.txt -u http://somesite.com -H "Host: FUZZ.somesite.com"
```
